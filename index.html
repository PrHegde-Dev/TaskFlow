<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checklist Application</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .app-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            width: 100%;
            max-width: 600px;
            min-height: 500px;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #f0f0f0;
        }

        .header h1 {
            color: #667eea;
            font-size: 2.2rem;
            margin-bottom: 10px;
        }

        .header p {
            color: #666;
            font-size: 1rem;
        }

        .menu {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #e9ecef;
        }

        .menu h2 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3rem;
            text-align: center;
        }

        .menu-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .menu-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
            text-align: center;
        }

        .menu-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .menu-btn:active {
            transform: translateY(0);
        }

        .exit-btn {
            grid-column: span 2;
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .exit-btn:hover {
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        .content-area {
            background: white;
            border-radius: 10px;
            padding: 20px;
            border: 2px solid #e9ecef;
            min-height: 300px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .input-field {
            flex: 1;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .input-field:focus {
            outline: none;
            border-color: #667eea;
        }

        .action-btn {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .danger-btn {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }

        .danger-btn:hover {
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        .checklist-display {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .checklist-display h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2rem;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 1px solid #dee2e6;
        }

        .task-list {
            list-style: none;
        }

        .task-item {
            background: white;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .task-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        }

        .task-text {
            font-size: 1rem;
            color: #333;
        }

        .task-status {
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-completed {
            background: #d1edff;
            color: #0c5aa6;
        }

        .status-incomplete {
            background: #fff3cd;
            color: #856404;
        }

        .empty-message {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            padding: 40px;
            font-size: 1.1rem;
        }

        .status-section {
            margin-top: 20px;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .status-box {
            background: white;
            border-radius: 8px;
            padding: 15px;
            border: 1px solid #e9ecef;
        }

        .status-box h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1rem;
            text-align: center;
        }

        .status-box.completed h4 {
            color: #28a745;
        }

        .status-box.incomplete h4 {
            color: #ffc107;
        }

        .status-list {
            list-style: none;
        }

        .status-list li {
            background: #f8f9fa;
            padding: 8px 12px;
            margin-bottom: 5px;
            border-radius: 5px;
            font-size: 0.9rem;
        }

        .message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 15px;
            font-size: 0.9rem;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }

        .hidden {
            display: none;
        }

        .mark-status-area {
            background: #e7f3ff;
            border: 1px solid #b8daff;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
        }

        .mark-status-area h4 {
            color: #004085;
            margin-bottom: 15px;
            text-align: center;
        }

        .task-status-item {
            background: white;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .status-buttons {
            display: flex;
            gap: 10px;
        }

        .status-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .yes-btn {
            background: #28a745;
            color: white;
        }

        .no-btn {
            background: #6c757d;
            color: white;
        }

        .yes-btn:hover {
            background: #218838;
        }

        .no-btn:hover {
            background: #545b62;
        }

        @media (max-width: 768px) {
            .app-container {
                padding: 20px;
                margin: 10px;
            }

            .menu-buttons {
                grid-template-columns: 1fr;
            }

            .status-section {
                grid-template-columns: 1fr;
            }

            .input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="header">
            <h1>📋 Checklist Application</h1>
            <p>Manage your tasks efficiently</p>
        </div>

        <!-- Menu Section -->
        <div class="menu" id="menu">
            <h2>--- Menu ---</h2>
            <div class="menu-buttons">
                <button class="menu-btn" onclick="viewChecklist()">1. View Checklist</button>
                <button class="menu-btn" onclick="showAddTask()">2. Add Task</button>
                <button class="menu-btn" onclick="showRemoveTask()">3. Remove Task</button>
                <button class="menu-btn" onclick="showMarkStatus()">4. Mark Task Status</button>
                <button class="menu-btn exit-btn" onclick="saveAndExit()">5. Save and Exit</button>
            </div>
        </div>

        <!-- Content Area -->
        <div class="content-area" id="content">
            <div class="empty-message">
                Welcome! Select an option from the menu above to get started.
            </div>
        </div>
    </div>

    <script>
        class ChecklistApp {
            constructor() {
                this.checklist = [];
                this.completedTasks = [];
                this.incompleteTasks = [];
                this.loadChecklist();
                this.initializeDefaultTasks();
            }

            // Save checklist to localStorage
            saveChecklist() {
                const data = {
                    checklist: this.checklist,
                    completed_tasks: this.completedTasks,
                    incomplete_tasks: this.incompleteTasks,
                    lastUpdated: new Date().toISOString()
                };
                localStorage.setItem('checklist_data', JSON.stringify(data));
                console.log('Checklist saved to localStorage');
            }

            // Load checklist from localStorage
            loadChecklist() {
                try {
                    const data = localStorage.getItem('checklist_data');
                    if (data) {
                        const parsed = JSON.parse(data);
                        this.checklist = parsed.checklist || [];
                        this.completedTasks = parsed.completed_tasks || [];
                        this.incompleteTasks = parsed.incomplete_tasks || [];
                        console.log('Checklist loaded from localStorage');
                        return true;
                    }
                } catch (error) {
                    console.error('Error loading checklist:', error);
                }
                console.log('No saved checklist found. Starting with empty checklist.');
                return false;
            }

            // Initialize with default tasks if no data loaded
            initializeDefaultTasks() {
                if (this.checklist.length === 0) {
                    this.checklist = ["wake up", "do assignments", "eat lunch", "go to sleep"];
                    this.incompleteTasks = [...this.checklist]; // All tasks initially incomplete
                    this.completedTasks = [];
                }
            }

            // Display tasks in the content area
            displayTasks() {
                const content = document.getElementById('content');
                
                if (this.checklist.length === 0) {
                    content.innerHTML = `
                        <div class="checklist-display">
                            <h3>--- Your Checklist ---</h3>
                            <div class="empty-message">Your checklist is empty.</div>
                        </div>
                    `;
                    return;
                }

                let taskListHtml = '';
                this.checklist.forEach((task, index) => {
                    const status = this.completedTasks.includes(task) ? 'Completed' : 'Incomplete';
                    const statusClass = status === 'Completed' ? 'status-completed' : 'status-incomplete';
                    
                    taskListHtml += `
                        <div class="task-item">
                            <span class="task-text">${index + 1}. ${this.escapeHtml(task)}</span>
                            <span class="task-status ${statusClass}">${status}</span>
                        </div>
                    `;
                });

                content.innerHTML = `
                    <div class="checklist-display">
                        <h3>--- Your Checklist ---</h3>
                        <div class="task-list">
                            ${taskListHtml}
                        </div>
                        <div class="status-section">
                            <div class="status-box completed">
                                <h4>✅ Completed Tasks (${this.completedTasks.length})</h4>
                                <ul class="status-list">
                                    ${this.completedTasks.length === 0 ? 
                                        '<li>No completed tasks.</li>' : 
                                        this.completedTasks.map(task => `<li>- ${this.escapeHtml(task)}</li>`).join('')
                                    }
                                </ul>
                            </div>
                            <div class="status-box incomplete">
                                <h4>⏳ Incomplete Tasks (${this.incompleteTasks.length})</h4>
                                <ul class="status-list">
                                    ${this.incompleteTasks.length === 0 ? 
                                        '<li>No incomplete tasks.</li>' : 
                                        this.incompleteTasks.map(task => `<li>- ${this.escapeHtml(task)}</li>`).join('')
                                    }
                                </ul>
                            </div>
                        </div>
                    </div>
                `;
            }

            // Add a new task
            addTask(newTask) {
                if (!newTask || newTask.trim() === '') {
                    return { success: false, message: "Task cannot be empty." };
                }

                newTask = newTask.trim();

                if (this.checklist.includes(newTask)) {
                    return { success: false, message: "Task already exists." };
                }

                this.checklist.push(newTask);
                this.incompleteTasks.push(newTask); // New task is incomplete by default
                this.saveChecklist();
                
                return { success: true, message: `'${newTask}' added to the checklist.` };
            }

            // Remove a task
            removeTask(taskToRemove) {
                if (!taskToRemove || !this.checklist.includes(taskToRemove)) {
                    return { success: false, message: `'${taskToRemove}' not found in the checklist.` };
                }

                // Remove from checklist
                this.checklist = this.checklist.filter(task => task !== taskToRemove);
                
                // Remove from status lists
                this.completedTasks = this.completedTasks.filter(task => task !== taskToRemove);
                this.incompleteTasks = this.incompleteTasks.filter(task => task !== taskToRemove);
                
                this.saveChecklist();
                
                return { success: true, message: `'${taskToRemove}' removed from the checklist.` };
            }

            // Mark task status (yes/no for each task)
            markTaskStatus(taskStatuses) {
                this.completedTasks = [];
                this.incompleteTasks = [];

                for (let task in taskStatuses) {
                    if (taskStatuses[task] === 'yes') {
                        this.completedTasks.push(task);
                    } else {
                        this.incompleteTasks.push(task);
                    }
                }

                this.saveChecklist();
                return { success: true, message: "Task statuses updated successfully." };
            }

            // Utility function to escape HTML
            escapeHtml(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            }
        }

        // Initialize the app
        const app = new ChecklistApp();

        // Menu functions
        function viewChecklist() {
            app.displayTasks();
        }

        function showAddTask() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="checklist-display">
                    <h3>Add New Task</h3>
                    <div class="input-group">
                        <input type="text" class="input-field" id="new-task-input" 
                               placeholder="Enter the new task to add..." maxlength="200">
                        <button class="action-btn" onclick="executeAddTask()">Add Task</button>
                    </div>
                    <div id="add-message"></div>
                </div>
            `;
            document.getElementById('new-task-input').focus();
            
            // Add enter key listener
            document.getElementById('new-task-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    executeAddTask();
                }
            });
        }

        function executeAddTask() {
            const input = document.getElementById('new-task-input');
            const messageDiv = document.getElementById('add-message');
            const newTask = input.value.trim();

            const result = app.addTask(newTask);
            
            messageDiv.innerHTML = `
                <div class="message ${result.success ? '' : 'error-message'}">
                    ${result.message}
                </div>
            `;

            if (result.success) {
                input.value = '';
                input.focus();
                setTimeout(() => {
                    messageDiv.innerHTML = '';
                }, 3000);
            }
        }

        function showRemoveTask() {
            const content = document.getElementById('content');
            
            if (app.checklist.length === 0) {
                content.innerHTML = `
                    <div class="checklist-display">
                        <h3>Remove Task</h3>
                        <div class="empty-message">Your checklist is empty. Nothing to remove.</div>
                    </div>
                `;
                return;
            }

            let taskOptions = '';
            app.checklist.forEach((task, index) => {
                taskOptions += `
                    <div class="task-item" style="cursor: pointer;" onclick="selectTaskForRemoval('${task.replace(/'/g, "\\'")}')">
                        <span class="task-text">${index + 1}. ${app.escapeHtml(task)}</span>
                        <span style="color: #dc3545; font-weight: bold;">Click to Remove</span>
                    </div>
                `;
            });

            content.innerHTML = `
                <div class="checklist-display">
                    <h3>Remove Task</h3>
                    <p style="text-align: center; margin-bottom: 15px; color: #666;">
                        Click on any task below to remove it:
                    </p>
                    <div class="task-list">
                        ${taskOptions}
                    </div>
                    <div style="text-align: center; margin-top: 15px;">
                        <input type="text" class="input-field" id="remove-task-input" 
                               placeholder="Or type the exact task name to remove..." style="margin-bottom: 10px;">
                        <button class="action-btn danger-btn" onclick="executeRemoveTask()">Remove Task</button>
                    </div>
                    <div id="remove-message"></div>
                </div>
            `;
            
            // Add enter key listener
            document.getElementById('remove-task-input').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    executeRemoveTask();
                }
            });
        }

        function selectTaskForRemoval(taskName) {
            if (confirm(`Are you sure you want to remove "${taskName}"?`)) {
                const result = app.removeTask(taskName);
                const messageDiv = document.getElementById('remove-message');
                
                messageDiv.innerHTML = `
                    <div class="message ${result.success ? '' : 'error-message'}">
                        ${result.message}
                    </div>
                `;

                if (result.success) {
                    setTimeout(() => {
                        showRemoveTask(); // Refresh the remove task view
                    }, 1500);
                }
            }
        }

        function executeRemoveTask() {
            const input = document.getElementById('remove-task-input');
            const messageDiv = document.getElementById('remove-message');
            const taskToRemove = input.value.trim();

            if (!taskToRemove) {
                messageDiv.innerHTML = `
                    <div class="message error-message">
                        Please enter a task name or click on a task above.
                    </div>
                `;
                return;
            }

            if (confirm(`Are you sure you want to remove "${taskToRemove}"?`)) {
                const result = app.removeTask(taskToRemove);
                
                messageDiv.innerHTML = `
                    <div class="message ${result.success ? '' : 'error-message'}">
                        ${result.message}
                    </div>
                `;

                if (result.success) {
                    input.value = '';
                    setTimeout(() => {
                        showRemoveTask(); // Refresh the remove task view
                    }, 1500);
                }
            }
        }

        function showMarkStatus() {
            const content = document.getElementById('content');
            
            if (app.checklist.length === 0) {
                content.innerHTML = `
                    <div class="checklist-display">
                        <h3>Mark Task Status</h3>
                        <div class="empty-message">Your checklist is empty. Cannot mark tasks.</div>
                    </div>
                `;
                return;
            }

            let taskStatusHtml = '';
            app.checklist.forEach((task, index) => {
                taskStatusHtml += `
                    <div class="task-status-item">
                        <span class="task-text">Did you ${app.escapeHtml(task)}?</span>
                        <div class="status-buttons">
                            <button class="status-btn yes-btn" onclick="setTaskStatus('${task.replace(/'/g, "\\'")}', 'yes')">Yes</button>
                            <button class="status-btn no-btn" onclick="setTaskStatus('${task.replace(/'/g, "\\'")}', 'no')">No</button>
                        </div>
                    </div>
                `;
            });

            content.innerHTML = `
                <div class="checklist-display">
                    <h3>Mark Task Status</h3>
                    <div class="mark-status-area">
                        <h4>📋 Processing checklist for final status:</h4>
                        <div id="task-status-list">
                            ${taskStatusHtml}
                        </div>
                        <div style="text-align: center; margin-top: 20px;">
                            <button class="action-btn" onclick="finishMarkingStatus()" id="finish-btn" disabled>
                                Finish Marking Status
                            </button>
                        </div>
                    </div>
                    <div id="status-message"></div>
                </div>
            `;

            // Initialize tracking
            window.taskStatusTracker = {};
            window.totalTasks = app.checklist.length;
            window.markedTasks = 0;
        }

        function setTaskStatus(taskName, status) {
            // Update the task status tracker
            if (!window.taskStatusTracker[taskName]) {
                window.markedTasks++;
            }
            window.taskStatusTracker[taskName] = status;

            // Update button states
            const taskItems = document.querySelectorAll('.task-status-item');
            taskItems.forEach(item => {
                const taskText = item.querySelector('.task-text').textContent;
                if (taskText.includes(taskName)) {
                    const buttons = item.querySelectorAll('.status-btn');
                    buttons.forEach(btn => btn.style.opacity = '0.5');
                    
                    const selectedBtn = item.querySelector(`.${status}-btn`);
                    if (selectedBtn) {
                        selectedBtn.style.opacity = '1';
                        selectedBtn.style.backgroundColor = status === 'yes' ? '#20c997' : '#495057';
                    }
                }
            });

            // Enable finish button if all tasks are marked
            if (window.markedTasks === window.totalTasks) {
                document.getElementById('finish-btn').disabled = false;
                document.getElementById('finish-btn').style.background = 'linear-gradient(135deg, #28a745, #20c997)';
            }

            // Show progress
            document.getElementById('status-message').innerHTML = `
                <div class="message">
                    Progress: ${window.markedTasks}/${window.totalTasks} tasks marked
                </div>
            `;
        }

        function finishMarkingStatus() {
            const result = app.markTaskStatus(window.taskStatusTracker);
            
            document.getElementById('status-message').innerHTML = `
                <div class="message">
                    ${result.message} Displaying updated checklist...
                </div>
            `;

            setTimeout(() => {
                app.displayTasks();
            }, 2000);
        }

        function saveAndExit() {
            app.saveChecklist();
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="checklist-display">
                    <h3>💾 Save and Exit</h3>
                    <div style="text-align: center; padding: 40px;">
                        <div class="message">
                            ✅ Checklist saved successfully!<br>
                            Thank you for using the Checklist Application.
                        </div>
                        <p style="color: #666; margin-top: 20px;">
                            Your data is safely stored in your browser.<br>
                            You can refresh the page or come back later - your tasks will be here!
                        </p>
                        <button class="action-btn" onclick="location.reload()" style="margin-top: 20px;">
                            🔄 Start Over
                        </button>
                    </div>
                </div>
            `;
        }

        // Initialize the app with welcome message
        document.addEventListener('DOMContentLoaded', function() {
            const content = document.getElementById('content');
            content.innerHTML = `
                <div class="checklist-display">
                    <h3>Welcome to Your Checklist Application!</h3>
                    <div style="text-align: center; padding: 20px;">
                        <p style="color: #666; margin-bottom: 20px;">
                            ${app.checklist.length > 0 ? 
                                `You have ${app.checklist.length} tasks in your checklist.` : 
                                'Your checklist is ready to use.'
                            }
                        </p>
                        <button class="action-btn" onclick="viewChecklist()">
                            📋 View My Checklist
                        </button>
                    </div>
                </div>
            `;
        });
    </script>
</body>
</html>